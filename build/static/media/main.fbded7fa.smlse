(storage (record 93 (allowance (literal (intOrNat 0) 93)) (balance (literal (intOrNat 0) 93)) (extraNonce (type_annotation (map 102 ) (map (unknown 1) (record ((value "nat")) None)) 102)) (owner (literal (address "tz1iW8VsjiskuidR5EwSv7JUkttVZHDgKtfi") -1)) (reqGasPrice (variant "None" (unit) -1)) (reqPeriodSeconds (variant "None" (unit) -1)) (reqToAddress (variant "None" (unit) -1)) (reqTokenAddress (variant "None" (unit) -1)) (reqTokenAmount (variant "None" (unit) -1)) (times (type_annotation (big_map 94 ) (bigmap "bytes" (record ((active "bool") (nextValidTimeStamp "timestamp") (ready "bool")) None)) 94)))
storage_type (())
messages ((cancelSub True ((set_type (params 255) (record ((gasPrice "nat") (nonce "nat") (periodSeconds "int") (publisher "address") (subs_pub_key "key") (subscriber "address") (tokenAddress "address") (tokenAmount "nat") (userSignature "signature")) (Some (("subscriber") (("publisher") (("tokenAddress") (("tokenAmount") (("periodSeconds") (("gasPrice") (("nonce") (("userSignature") ("subs_pub_key"))))))))))) 256) (set_type (record 257 (gasPrice (attr (params 255) "gasPrice" 263)) (nonce (attr (params 255) "nonce" 264)) (periodSeconds (attr (params 255) "periodSeconds" 262)) (publisher (attr (params 255) "publisher" 259)) (subscriber (attr (params 255) "subscriber" 258)) (tokenAddress (attr (params 255) "tokenAddress" 260)) (tokenAmount (attr (params 255) "tokenAmount" 261))) (record ((gasPrice "nat") (nonce "nat") (periodSeconds "int") (publisher "address") (subscriber "address") (tokenAddress "address") (tokenAmount "nat")) (Some (("subscriber") (("publisher") (("tokenAddress") (("tokenAmount") (("periodSeconds") (("gasPrice") ("nonce"))))))))) 164) (verify (or (invert (isVariant (attr (data) "reqToAddress" 165) "Some" 165) 165) (and (isVariant (attr (data) "reqToAddress" 165) "Some" 165) (eq (openVariant (attr (data) "reqToAddress" 165) "Some" 165) (attr (params 255) "publisher" 259) 165) 165) 165) False 165) (verify (or (invert (isVariant (attr (data) "reqTokenAddress" 166) "Some" 166) 166) (and (isVariant (attr (data) "reqTokenAddress" 166) "Some" 166) (eq (openVariant (attr (data) "reqTokenAddress" 166) "Some" 166) (attr (params 255) "tokenAddress" 260) 166) 166) 166) False 166) (verify (or (invert (isVariant (attr (data) "reqTokenAmount" 167) "Some" 167) 167) (and (isVariant (attr (data) "reqTokenAmount" 167) "Some" 167) (eq (openVariant (attr (data) "reqTokenAmount" 167) "Some" 167) (attr (params 255) "tokenAmount" 261) 167) 167) 167) False 167) (verify (or (invert (isVariant (attr (data) "reqPeriodSeconds" 168) "Some" 168) 168) (and (isVariant (attr (data) "reqPeriodSeconds" 168) "Some" 168) (eq (openVariant (attr (data) "reqPeriodSeconds" 168) "Some" 168) (attr (params 255) "periodSeconds" 262) 168) 168) 168) False 168) (verify (or (invert (isVariant (attr (data) "reqGasPrice" 169) "Some" 169) 169) (and (isVariant (attr (data) "reqGasPrice" 169) "Some" 169) (eq (openVariant (attr (data) "reqGasPrice" 169) "Some" 169) (attr (params 255) "gasPrice" 263) 169) 169) 169) False 169) (defineLocal "elements" (pack (record 172 (a (attr (params 255) "subscriber" 258)) (b (attr (params 255) "publisher" 259)) (c (attr (params 255) "tokenAddress" 260)) (d (attr (params 255) "tokenAmount" 261)) (e (attr (params 255) "periodSeconds" 262)) (f (attr (params 255) "gasPrice" 263)) (g (attr (params 255) "nonce" 264))) 171) 257) (verify (check_signature (attr (params 255) "subs_pub_key" 267) (attr (params 255) "userSignature" 267) (getLocal "elements" 267) 267) False 267) (verify (eq (sender) (attr (params 255) "subscriber" 258) 268) False 268) (set (attr (getItem (attr (data) "times" 269) (getLocal "elements" 269) 269) "nextValidTimeStamp" 269) (literal (timestamp -1) 269) 269))) (executeSubs True ((set_type (params 215) (record ((gasPrice "nat") (nonce "nat") (periodSeconds "int") (publisher "address") (subs_pub_key "key") (subscriber "address") (tokenAddress "address") (tokenAmount "nat") (userSignature "signature")) (Some (("subscriber") (("publisher") (("tokenAddress") (("tokenAmount") (("periodSeconds") (("gasPrice") (("nonce") (("userSignature") ("subs_pub_key"))))))))))) 216) (set_type (record 217 (gasPrice (attr (params 215) "gasPrice" 223)) (nonce (attr (params 215) "nonce" 224)) (periodSeconds (attr (params 215) "periodSeconds" 222)) (publisher (attr (params 215) "publisher" 219)) (subscriber (attr (params 215) "subscriber" 218)) (tokenAddress (attr (params 215) "tokenAddress" 220)) (tokenAmount (attr (params 215) "tokenAmount" 221))) (record ((gasPrice "nat") (nonce "nat") (periodSeconds "int") (publisher "address") (subscriber "address") (tokenAddress "address") (tokenAmount "nat")) (Some (("subscriber") (("publisher") (("tokenAddress") (("tokenAmount") (("periodSeconds") (("gasPrice") ("nonce"))))))))) 164) (verify (or (invert (isVariant (attr (data) "reqToAddress" 165) "Some" 165) 165) (and (isVariant (attr (data) "reqToAddress" 165) "Some" 165) (eq (openVariant (attr (data) "reqToAddress" 165) "Some" 165) (attr (params 215) "publisher" 219) 165) 165) 165) False 165) (verify (or (invert (isVariant (attr (data) "reqTokenAddress" 166) "Some" 166) 166) (and (isVariant (attr (data) "reqTokenAddress" 166) "Some" 166) (eq (openVariant (attr (data) "reqTokenAddress" 166) "Some" 166) (attr (params 215) "tokenAddress" 220) 166) 166) 166) False 166) (verify (or (invert (isVariant (attr (data) "reqTokenAmount" 167) "Some" 167) 167) (and (isVariant (attr (data) "reqTokenAmount" 167) "Some" 167) (eq (openVariant (attr (data) "reqTokenAmount" 167) "Some" 167) (attr (params 215) "tokenAmount" 221) 167) 167) 167) False 167) (verify (or (invert (isVariant (attr (data) "reqPeriodSeconds" 168) "Some" 168) 168) (and (isVariant (attr (data) "reqPeriodSeconds" 168) "Some" 168) (eq (openVariant (attr (data) "reqPeriodSeconds" 168) "Some" 168) (attr (params 215) "periodSeconds" 222) 168) 168) 168) False 168) (verify (or (invert (isVariant (attr (data) "reqGasPrice" 169) "Some" 169) 169) (and (isVariant (attr (data) "reqGasPrice" 169) "Some" 169) (eq (openVariant (attr (data) "reqGasPrice" 169) "Some" 169) (attr (params 215) "gasPrice" 223) 169) 169) 169) False 169) (defineLocal "elements" (pack (record 172 (a (attr (params 215) "subscriber" 218)) (b (attr (params 215) "publisher" 219)) (c (attr (params 215) "tokenAddress" 220)) (d (attr (params 215) "tokenAmount" 221)) (e (attr (params 215) "periodSeconds" 222)) (f (attr (params 215) "gasPrice" 223)) (g (attr (params 215) "nonce" 224))) 171) 217) (set_type (record 227 (gasPrice (attr (params 215) "gasPrice" 223)) (nonce (attr (params 215) "nonce" 224)) (periodSeconds (attr (params 215) "periodSeconds" 222)) (publisher (attr (params 215) "publisher" 219)) (subs_pub_key (attr (params 215) "subs_pub_key" 236)) (subscriber (attr (params 215) "subscriber" 218)) (tokenAddress (attr (params 215) "tokenAddress" 220)) (tokenAmount (attr (params 215) "tokenAmount" 221)) (userSignature (attr (params 215) "userSignature" 235))) (record ((gasPrice "nat") (nonce "nat") (periodSeconds "int") (publisher "address") (subs_pub_key "key") (subscriber "address") (tokenAddress "address") (tokenAmount "nat") (userSignature "signature")) (Some (("subscriber") (("publisher") (("tokenAddress") (("tokenAmount") (("periodSeconds") (("gasPrice") (("nonce") (("userSignature") ("subs_pub_key"))))))))))) 185) (set_type (record 187 (gasPrice (attr (params 215) "gasPrice" 223)) (nonce (attr (params 215) "nonce" 224)) (periodSeconds (attr (params 215) "periodSeconds" 222)) (publisher (attr (params 215) "publisher" 219)) (subscriber (attr (params 215) "subscriber" 218)) (tokenAddress (attr (params 215) "tokenAddress" 220)) (tokenAmount (attr (params 215) "tokenAmount" 221))) (record ((gasPrice "nat") (nonce "nat") (periodSeconds "int") (publisher "address") (subscriber "address") (tokenAddress "address") (tokenAmount "nat")) (Some (("subscriber") (("publisher") (("tokenAddress") (("tokenAmount") (("periodSeconds") (("gasPrice") ("nonce"))))))))) 164) (verify (or (invert (isVariant (attr (data) "reqToAddress" 165) "Some" 165) 165) (and (isVariant (attr (data) "reqToAddress" 165) "Some" 165) (eq (openVariant (attr (data) "reqToAddress" 165) "Some" 165) (attr (params 215) "publisher" 219) 165) 165) 165) False 165) (verify (or (invert (isVariant (attr (data) "reqTokenAddress" 166) "Some" 166) 166) (and (isVariant (attr (data) "reqTokenAddress" 166) "Some" 166) (eq (openVariant (attr (data) "reqTokenAddress" 166) "Some" 166) (attr (params 215) "tokenAddress" 220) 166) 166) 166) False 166) (verify (or (invert (isVariant (attr (data) "reqTokenAmount" 167) "Some" 167) 167) (and (isVariant (attr (data) "reqTokenAmount" 167) "Some" 167) (eq (openVariant (attr (data) "reqTokenAmount" 167) "Some" 167) (attr (params 215) "tokenAmount" 221) 167) 167) 167) False 167) (verify (or (invert (isVariant (attr (data) "reqPeriodSeconds" 168) "Some" 168) 168) (and (isVariant (attr (data) "reqPeriodSeconds" 168) "Some" 168) (eq (openVariant (attr (data) "reqPeriodSeconds" 168) "Some" 168) (attr (params 215) "periodSeconds" 222) 168) 168) 168) False 168) (verify (or (invert (isVariant (attr (data) "reqGasPrice" 169) "Some" 169) 169) (and (isVariant (attr (data) "reqGasPrice" 169) "Some" 169) (eq (openVariant (attr (data) "reqGasPrice" 169) "Some" 169) (attr (params 215) "gasPrice" 223) 169) 169) 169) False 169) (defineLocal "element" (pack (record 172 (a (attr (params 215) "subscriber" 218)) (b (attr (params 215) "publisher" 219)) (c (attr (params 215) "tokenAddress" 220)) (d (attr (params 215) "tokenAmount" 221)) (e (attr (params 215) "periodSeconds" 222)) (f (attr (params 215) "gasPrice" 223)) (g (attr (params 215) "nonce" 224))) 171) 186) (ifBlock (invert (contains (attr (data) "times" 269) (getLocal "element" 197) 127) 127) ((set (getItem (attr (data) "times" 269) (getLocal "element" 197) 128) (record 128 (active (literal (bool False) 128)) (nextValidTimeStamp (literal (timestamp -1) 128)) (ready (literal (bool False) 128))) 128)) 127) (set (attr (getItem (attr (data) "times" 269) (getLocal "element" 198) 198) "ready" 198) (literal (bool False) 198) 198) (verify (check_signature (attr (params 215) "subs_pub_key" 236) (attr (params 215) "userSignature" 235) (getLocal "element" 199) 199) False 199) (verify (neq (attr (params 215) "subscriber" 218) (attr (params 215) "publisher" 219) 200) False 200) (verify (ge (now) (attr (getItem (attr (data) "times" 269) (getLocal "element" 201) 201) "nextValidTimeStamp" 201) 201) False 201) (set (attr (getItem (attr (data) "times" 269) (getLocal "element" 202) 202) "ready" 202) (literal (bool True) 202) 202) (verify (eq (attr (getItem (attr (data) "times" 269) (getLocal "elements" 239) 239) "ready" 239) (literal (bool True) 239) 239) False 239) (set (attr (getItem (attr (data) "times" 269) (getLocal "elements" 240) 240) "nextValidTimeStamp" 240) (add_seconds (now) (attr (params 215) "periodSeconds" 222) 240) 240) (ifBlock (invert (contains (attr (data) "extraNonce" 131) (attr (params 215) "subscriber" 218) 131) 131) ((set (getItem (attr (data) "extraNonce" 131) (attr (params 215) "subscriber" 218) 132) (record 132 (value (literal (intOrNat 0) 132))) 132)) 131) (ifBlock (gt (attr (params 215) "nonce" 224) (attr (getItem (attr (data) "extraNonce" 131) (attr (params 215) "subscriber" 218) 242) "value" 242) 242) ((set (attr (getItem (attr (data) "extraNonce" 131) (attr (params 215) "subscriber" 218) 243) "value" 243) (attr (params 215) "nonce" 224) 243)) 242) (set (operations 247) (cons (transfer (record 246 (from_ (attr (params 215) "subscriber" 218)) (to_ (attr (params 215) "publisher" 219)) (value (attr (params 215) "tokenAmount" 221))) (literal (mutez 0) 247) (openVariant (contract "transfer" (record ((from_ "address") (to_ "address") (value "nat")) None) (attr (params 215) "tokenAddress" 220) 245) "Some" 245) 247) (operations 247) 247) 247) (ifBlock (gt (attr (params 215) "gasPrice" 223) (literal (intOrNat 0) 249) 249) ((set (operations 252) (cons (transfer (record 251 (from_ (attr (params 215) "subscriber" 218)) (to_ (sender)) (value (attr (params 215) "gasPrice" 223))) (literal (mutez 0) 252) (openVariant (contract "transfer" (record ((from_ "address") (to_ "address") (value "nat")) None) (attr (params 215) "tokenAddress" 220) 250) "Some" 250) 252) (operations 252) 252) 252)) 249))) (updateAllowance True ((set_type (params 149) (record ((spender "address") (subscriber "address") (tokenAddress "address")) (Some (("spender") (("subscriber") ("tokenAddress"))))) 150) (set (operations 161) (cons (transfer (record 160 (contractAddress (to_address (self) 160)) (owner (attr (params 149) "subscriber" 160)) (spender (attr (params 149) "spender" 160))) (literal (mutez 0) 161) (openVariant (contract "getAllowance" (record ((contractAddress "address") (owner "address") (spender "address")) None) (attr (params 149) "tokenAddress" 157) 151) "Some" 151) 161) (operations 161) 161) 161))) (updateBalance True ((set_type (params 135) (record ((subscriber "address") (tokenAddress "address")) (Some (("subscriber") ("tokenAddress")))) 136) (set (operations 146) (cons (transfer (record 145 (contractAddress (to_address (self) 145)) (owner (attr (params 135) "subscriber" 145))) (literal (mutez 0) 146) (openVariant (contract "getBalance" (record ((contractAddress "address") (owner "address")) None) (attr (params 135) "tokenAddress" 142) 137) "Some" 137) 146) (operations 146) 146) 146))) (viewAllowance True ((set_type (params 210) "nat" 211) (set (attr (data) "allowance" 212) (params 210) 212))) (viewBalance True ((set_type (params 205) "nat" 206) (set (attr (data) "balance" 207) (params 205) 207))))
flags ()
globals ()
storage_layout ()
entry_points_layout ())